{{- $page := .page }}
{{- $menuID := .menuID }}

{{- with index site.Menus $menuID }}
  <label id="menu-toggle" class="pointer-cursor md:hidden block text-gray-500">
      <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path class="inline-flex" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16" />
          <path class="hidden" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M6 18L18 6M6 6l12 12" />
      </svg>
  </label>

  <div class="shadow absolute md:relative md:shadow-none md:bg-transparent bg-gray-100 w-auto text-center md:flex hidden" id="menu">
    <nav class="shadow md:shadow-none">
      <ul class="md:flex items-center gap-2 justify-between text-base text-gray-700 pt-4 sm:pt-0 md:pt-0 text-left md:text-center ">
        {{- partial "inline/menu/walk.html" (dict "page" $page "menuEntries" .) }}
      </ul>
    </nav>
  </div>
{{- end }}

{{- define "partials/inline/menu/walk.html" }}

  {{- $page := .page }}

  {{- range .menuEntries }}
    {{- $attrs := dict "href" .URL }}
    {{- $attrs = merge $attrs (dict "class" "nav-link px-3 py-2 cursor-pointer") }}
    {{- if $page.IsMenuCurrent .Menu . }}
      {{- $attrs = merge $attrs (dict "class" "active" "aria-current" "page") }}
    {{- else if $page.HasMenuCurrent .Menu .}}
      {{- $attrs = merge $attrs (dict "class" "ancestor" "aria-current" "true") }}
    {{- end }}
    {{- $name := .Name }}
    {{- with .Identifier }}
      {{- with T . }}
        {{- $name = . }}
      {{- end }}
    {{- end }}
    <li class="w-full relative nav-li whitespace-nowrap hover:bg-gray-100 rounded-t group">
      <a
        {{- range $k, $v := $attrs }}
          {{- with $v }}
            {{- printf " %s=%q" $k $v | safeHTMLAttr }}
          {{- end }}
        {{- end -}}
      >
        {{- if .Children }}
        <i class="-rotate-90 fa fa-caret-down text-gray-300 group-hover:text-gray-500 mr-1 group-hover:rotate-0 transition-transform transform duration-300 ease-in-out"></i>
        {{- end }}
        {{ $name }}
      </a>
      {{- with .Children }}
        <ul class="dropdown-content hidden md:absolute relative md:shadow md:border-t md:border-l-0 border-l bg-gray-100 ">
          {{- range . }}
            {{- $attrs := dict "href" .URL }}
            {{- $attrs = merge $attrs (dict "class" "nav-link ml-0 xl:ml-4 px-3 py-2") }}
            {{- if $page.IsMenuCurrent .Menu . }}
              {{- $attrs = merge $attrs (dict "class" "active" "aria-current" "page") }}
            {{- else if $page.HasMenuCurrent .Menu .}}
              {{- $attrs = merge $attrs (dict "class" "ancestor" "aria-current" "true") }}
            {{- end }}
            {{- $name := .Name }}
            {{- with .Identifier }}
              {{- with T . }}
                {{- $name = . }}
              {{- end }}
            {{- end }}
            <li>
      <a
        {{- range $k, $v := $attrs }}
          {{- with $v }}
            {{- printf " %s=%q" $k $v | safeHTMLAttr }}
          {{- end }}
        {{- end -}}
      >{{ $name }}</a>

            </li>
          {{- end }}

        </ul>
      {{- end }}
    </li>
  {{- end }}
{{- end }}
